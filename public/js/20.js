(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{KZnh:function(t,e,i){"use strict";i.r(e);var s=i("Ql3O"),a=i("osEC"),o=i("Wz0r"),n={name:"FileInput",methods:{open:function(){this.$refs.fileInput.click()},change:function(t){this.$emit("change",t)}}},l=i("KHd+"),r=Object(l.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("input",{ref:"fileInput",staticClass:"d-none",attrs:{type:"file",accept:"image/jpeg, image/png, video/mp4, video/avi"},on:{change:this.change}}),this._v(" "),e("div",{on:{click:this.open}},[this._t("default",[e("button",{staticClass:"btn btn-primary"},[this._v("File Select")])])],2)])}),[],!1,null,null,null).exports,c={methods:{newCategory:function(t){this.categories.push({name:t,id:t}),axios.post("/categories",{name:t})},cropImage:function(){var t=this;this.isCroppingDone=!0,this.isCropping=!1;var e=this.$refs.cropper.getResult(),i=e.canvas,s=e.coordinates;i.toBlob((function(e){t.$refs.cropResult.src=URL.createObjectURL(e),t.cropCordinates=s}))},rotateImage:function(){var t=this,e=document.createElement("img");e.crossOrigin="anonymous",e.src=this.image,e.onload=function(){var i=document.createElement("canvas"),s=i.getContext("2d");e.width>e.height?(i.width=e.height,i.height=e.width,s.translate(e.height,e.width/e.height)):(i.height=e.width,i.width=e.height,s.translate(e.height,e.width/e.height)),s.rotate(Math.PI/2),s.drawImage(e,0,0),t.image=i.toDataURL()}},removeMedia:function(){this.isCroppingDone=!1,this.$refs.cropResult&&(this.$refs.cropResult.src=""),this.file=!1,this.image=void 0,this.video=void 0},imageSelect:function(t){var e=t.target;if(e.files&&e.files[0]){var i=t.target.files[0],s=i.type,a=URL.createObjectURL(i);s.startsWith("image")?(this.file=i,this.video=void 0,this.image=a,this.isCropping=!0):s.startsWith("video")&&(this.isCropping=!1,this.file=i,this.image=void 0,this.video=a)}},submitPost:function(){var t=this;this.loading=!0;var e=new FormData;e.append("text",this.text),this.category&&e.append("category",this.category.value),e.append("type",this.showType.value),e.append("tags",JSON.stringify(this.tags)),void 0!==this.file&&(e.append("media",this.file),void 0!==this.cropCordinates&&e.append("sizes",JSON.stringify(this.cropCordinates))),axios.post(this.$APP_URL+"/posts",e).then((function(e){var i=e.data;if(i.result)o.Inertia.reload({only:["posts"]}),t.$emit("update:show",!1);else{var s=i.errors;t.handleError(s)}})).catch((function(t){})).then((function(){return t.loading=!1}))}},watch:{text:function(t){this.txtlen=t.length/2500*100+"%",this.leftCharacter=2500-t.length}},created:function(){this.showType=this.showTypesItems[0]},data:function(){return{showTypesItems:[{name:"همه",value:"public",icon:"public"},{name:"فقط دوستان",value:"private",icon:"group"}],showType:void 0,category:void 0,text:void 0,categories:this.$page.user.page.categories,tags:[],txtlen:"0%",isCropping:!1,isCroppingDone:!1,image:void 0,video:void 0,file:void 0,cropCordinates:void 0,loading:!1,leftCharacter:2500}},components:{Cropper:a.a,FileInput:r},mixins:[s.a],name:"NewPostModal"},p=Object(l.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-modal",{attrs:{"no-close-on-backdrop":"","hide-footer":"",size:"lg",title:"تولید محتوای تازه",centered:!0},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[i("div",{staticClass:"w-100",attrs:{action:"/posts","data-ajax":"",method:"POST","data-reload":"1",enctype:"multipart/form-data"}},[i("div",{staticClass:"new-post position-relative"},[i("div",{staticClass:"selections"},[i("div",{staticClass:"userinfo col-lg-4 p-0"},[i("lazy-image",{staticClass:"profile m-0",attrs:{src:t.$page.user.profile,loading:"lazy"}}),t._v(" "),i("strong",[t._v(t._s(t.$page.user.name))])],1),t._v(" "),i("div",{staticClass:"categoryandtype"},[i("div",{staticClass:"mx-1 col-lg-5 p-0"},[i("tselect",{attrs:{items:t.showTypesItems,showNewItem:!1,direction:"rtl"},model:{value:t.showType,callback:function(e){t.showType=e},expression:"showType"}})],1),t._v(" "),i("div",{staticClass:"ml-1 p-0 col-lg-7"},[i("tselect",{attrs:{items:t.categories,"value-option":"name",showNewItem:!0,direction:"rtl"},on:{"new-item":t.newCategory},model:{value:t.category,callback:function(e){t.category=e},expression:"category"}},[i("i",{staticClass:"material-icons-outlined"},[t._v("layers")]),t._v(" دسته‌بندی\n                        ")])],1)])]),t._v(" "),i("div",{staticClass:"text px-0"},[i("div",{staticClass:"textarea"},[i("textarea-autosize",{staticClass:"w-100 autoresize autodirection",attrs:{"min-height":201,rows:"8",placeholder:"اگر در خویش میل نوشتن سراغ کردی باید سه چیز در تو باشد. شناختی، هنری و سحری (جبران خلیل جبران)",maxlength:"2500"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),t._v(" "),i("div",{staticClass:"character-counter"},[i("span",{staticClass:"counter tex-dark"},[t._v(t._s(t.leftCharacter))]),t._v(" "),i("div",{staticClass:"progress ml-1 mb-0",staticStyle:{width:"100px",height:"5px"}},[i("div",{staticClass:"progress-bar",style:{width:t.txtlen},attrs:{role:"progressbar","aria-valuemin":"0","aria-valuemax":"100"}})])])],1)]),t._v(" "),i("div",{staticClass:"mediatag"},[i("div",{staticClass:"position-relative",attrs:{id:"mediaPreview"}},[i("div",{staticClass:"topleftactions"},[t.isCropping?i("button",{staticClass:"closebtn",staticStyle:{height:"30px",width:"30px",padding:"3px"},on:{click:t.rotateImage}},[i("i",{staticClass:"material-icons"},[t._v("rotate_left")])]):t._e(),t._v(" "),void 0!==t.image||void 0!==t.video?i("button",{staticClass:"closebtn",on:{click:t.removeMedia}},[i("i",{staticClass:"material-icons font-22"},[t._v("close")])]):t._e()]),t._v(" "),t.isCropping?i("cropper",{ref:"cropper",staticClass:"cropper",attrs:{src:t.image,"stencil-props":{aspectRatio:16/12}}}):t._e(),t._v(" "),void 0!==t.video&&null!==t.video?i("video",{staticClass:"w-100",attrs:{src:t.video,controls:""}}):t._e(),t._v(" "),t.isCroppingDone?i("img",{ref:"cropResult",staticClass:"w-100"}):t._e(),t._v(" "),t.isCropping&&void 0!==t.image&&null!==t.image?i("div",{staticClass:"w-100 d-flex justify-content-center mb-3 position-relative"},[i("div",{staticClass:"cropperactions"},[i("button",{attrs:{type:"button"},on:{click:t.cropImage}},[t._v("تایید")]),t._v(" "),i("button",{attrs:{type:"button"},on:{click:function(e){t.isCropping=!1}}},[t._v("لغو")])])]):t._e()],1),t._v(" "),i("div",{staticClass:"tags pt-2 pr-0 pb-3"},[i("div",{staticClass:"d-flex align-items-center justify-content-between mb-2"},[i("div",{staticClass:"w-100 d-flex flex-column"},[i("span",{staticClass:"font-18 bold"},[t._v("برچسب‌ها")]),t._v(" "),i("span",{staticClass:"text-muted bold font-11"},[t._v("حداکثر ۳ برچست")])])]),t._v(" "),i("div",{staticClass:"d-flex align-items-center"},[i("v-select",{staticClass:"w-100",attrs:{dir:"rtl",taggable:"",multiple:"","push-tags":""},scopedSlots:t._u([{key:"open-indicator",fn:function(){return[i("span")]},proxy:!0}]),model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}}),t._v(" "),i("div",{staticClass:"d-flex align-items-center"},[i("file-input",{on:{change:t.imageSelect}},[i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-grey d-flex align-items-center clickable",attrs:{title:"افزودن ویدیو / تصویر"}},[i("i",{staticClass:"material-icons-outlined text-grey"},[t._v("crop_original")])])]),t._v(" "),i("span",{staticClass:"splitor-line mx-2"}),t._v(" "),i("inertia-link",{staticClass:"text-grey d-flex align-items-center font-12",attrs:{href:"/articles/create","data-toggle":"tooltip",title:"","data-placement":"bottom","data-original-title":"افزودن مقاله"}},[i("i",{staticClass:"material-icons-outlined text-grey"},[t._v("article")])])],1)],1)])]),t._v(" "),i("div",{staticClass:"media pl-2"},[i("input",{attrs:{type:"hidden",name:"sizes",value:"",id:"postimage-options"}})]),t._v(" "),i("div",{staticClass:"submit position-relative"},[i("loading-button",{staticClass:"btn btn-primary",staticStyle:{"margin-bottom":"-8px"},attrs:{loading:t.loading},nativeOn:{click:function(e){return t.submitPost(e)}}},[t._v("\n                    ارسال\n                ")])],1)])])])}),[],!1,null,null,null);e.default=p.exports},Ql3O:function(t,e,i){"use strict";var s={created:function(){this.showModal=this.show},data:function(){return{showModal:!1}},watch:{show:function(t){this.showModal=this.show},showModal:function(t){this.$emit("update:show",t)}},props:{show:{type:Boolean,default:!1,required:!1}}};e.a=s}}]);
//# sourceMappingURL=20.js.map